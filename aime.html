<!DOCTYPE html>
<html lang="zh-CN" data-theme="dark">
<!--        ğŸ’ æ„Ÿè°¢NAGEKI-NET~ ğŸ’
           ğŸ’ æ„Ÿè°¢è®¯é£æ˜Ÿç«å¤§æ¨¡å‹~ ğŸ’
ğŸ’ OpenSource without love by Eternal973~ ğŸ’-->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reigeki ID</title>
</head>

<body>
    <noscript>
        <h1>è¯·å…è®¸JavaScriptä»¥ç»§ç»­ä½¿ç”¨å£ç‰™ï¼</h1>
    </noscript>
    <p id="running" style="display:none; color: darkred;">æ­£åœ¨è·å–ç©å®¶æ¡£æ¡ˆâ€¦â€¦</p><br>
    <script>
        function readAimeId() {
            document.getElementById("running").style.display = "inline";
            const para = location.search;
            const paraRegex = /([^=]+)=([^&]+)/g;
            let match;
            const paraArray = [];
            while ((match = paraRegex.exec(para)) !== null) {
                const key = match[1];
                const value = match[2];
                paraArray.push([key, value]);
            }
            if (para != "") {
                accessCode = paraArray[0][1];
                fetch('https://nageki.nananana.net/api/sega/aime/getByAccessCode', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ 'accessCode': accessCode })
                })
                    .then(response => response.json())
                    .then(data => {
                        let aimeId;
                        if (data.id && data.extId) {
                            aimeId = data.extId;
                            console.log(aimeId);
                            fetch(`https://nageki.nananana.net/OngekiServlet/GetUserDataApi`, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({ "nonce_": -114514191, "userId": aimeId })
                            })
                                .then(response => response.json())
                                .then(data => {
                                    if (data.userId && data.userData) {
                                        console.log(data.userData.userName+`ç™»å½•æˆåŠŸ`)
                                    } else {
                                        alert('è·å–æ•°æ®å¤±è´¥ï¼');
                                    }
                                })
                                .catch(error => {
                                    console.error('è¯·æ±‚é”™è¯¯ï¼š', error);
                                    alert('è¯·æ±‚å‡ºé”™ï¼Œè¯·ç¨åé‡è¯•ï¼');
                                });
                        } else {
                            alert('è·å–idå¼‚å¸¸ï¼Œè¯·æ£€æŸ¥æ˜¯å¦ä¸ºNageki Netæ³¨å†Œå¡ï¼');
                        }
                    })
                    .catch(error => {
                        console.error('è¯·æ±‚é”™è¯¯ï¼š', error);
                        alert('è¯·æ±‚å‡ºé”™ï¼Œè¯·æ£€æŸ¥æ˜¯å¦ä¸ºNageki Netæ³¨å†Œå¡ï¼');
                    });
            }
            else {
                alert('äºŒç»´ç å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥å®¢æˆ·ç«¯æ˜¯å¦æ”¯æŒReigeki IDï¼');
            }
            document.getElementById("running").style.display = "none";
        }
    </script>
    <script language="JavaScript" type="text/javascript">readAimeId();</script>
</body>